<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instructor Dashboard - Growth Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        dark: '#1E293B',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Navigation -->
    <nav class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <a href="index.html" class="text-2xl font-bold text-primary">Growth Lab</a>
                </div>
                <div class="hidden md:flex space-x-6">
                    <a href="index.html" class="text-dark hover:text-primary transition">Home</a>
                    <a href="courses.html" class="text-dark hover:text-primary transition">Courses</a>
                    <a href="contact.html" class="text-dark hover:text-primary transition">Contact</a>
                </div>
                <div class="hidden items-center space-x-4" id="user-menu">
                    <div class="relative" id="dropdown-container">
                        <button id="dropdown-button" class="flex items-center space-x-1">
                            <span id="username">User</span>
                            <i class="fas fa-chevron-down text-sm"></i>
                        </button>
                        <div id="dropdown-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 hidden">
                            <a href="profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Profile</a>
                            <a href="instructor-dashboard.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 font-medium text-primary" id="instructor-link">Instructor Dashboard</a>
                            <a href="#" id="logout-button" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Logout</a>
                        </div>
                    </div>
                </div>
                <button class="md:hidden" id="mobile-menu-button">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="flex flex-col space-y-3 py-3">
                    <a href="index.html" class="text-dark hover:text-primary transition">Home</a>
                    <a href="courses.html" class="text-dark hover:text-primary transition">Courses</a>
                    <a href="contact.html" class="text-dark hover:text-primary transition">Contact</a>
                    <div id="mobile-user-menu">
                        <a href="profile.html" class="block text-dark hover:text-primary transition">Profile</a>
                        <a href="instructor-dashboard.html" class="block text-primary font-medium transition" id="mobile-instructor-link">Instructor Dashboard</a>
                        <a href="#" id="mobile-logout-button" class="block text-dark hover:text-primary transition">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Dashboard Header -->
    <section class="bg-gradient-to-r from-blue-500 to-blue-700 text-white py-12">
        <div class="container mx-auto px-4">
            <h1 class="text-3xl font-bold mb-2">Instructor Dashboard</h1>
            <p class="text-xl">Manage your courses and track your progress</p>
        </div>
    </section>

    <!-- Dashboard Content -->
    <section class="py-12">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row gap-8">
                <!-- Sidebar -->
                <div class="md:w-1/4">
                    <div class="bg-white rounded-lg shadow-md p-6 sticky top-6">
                        <h2 class="text-xl font-semibold mb-6">Dashboard</h2>
                        <ul class="space-y-2">
                            <li>
                                <button id="tab-courses" class="w-full text-left py-2 px-3 rounded-md bg-blue-50 text-primary font-medium">
                                    <i class="fas fa-book-open mr-2"></i> My Courses
                                </button>
                            </li>
                            <li>
                                <button id="tab-add-course" class="w-full text-left py-2 px-3 rounded-md hover:bg-gray-100 transition">
                                    <i class="fas fa-plus mr-2"></i> Add New Course
                                </button>
                            </li>
                            <li>
                                <button id="tab-reviews" class="w-full text-left py-2 px-3 rounded-md hover:bg-gray-100 transition">
                                    <i class="fas fa-star mr-2"></i> Reviews
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div class="md:w-3/4">
                    <!-- My Courses Tab -->
                    <div id="content-courses" class="bg-white rounded-lg shadow-md p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-semibold">My Courses</h2>
                            <button id="add-course-button" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-blue-600 transition">
                                <i class="fas fa-plus mr-2"></i> Add New Course
                            </button>
                        </div>
                        
                        <div id="instructor-courses-loading" class="animate-pulse space-y-4">
                            <div class="h-16 bg-gray-200 rounded"></div>
                            <div class="h-16 bg-gray-200 rounded"></div>
                            <div class="h-16 bg-gray-200 rounded"></div>
                        </div>
                        
                        <div id="instructor-courses" class="hidden">
                            <div id="no-courses" class="text-center py-8 hidden">
                                <p class="text-gray-600 mb-4">You haven't created any courses yet.</p>
                                <button id="create-first-course" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-blue-600 transition">
                                    Create Your First Course
                                </button>
                            </div>
                            
                            <div id="courses-list" class="space-y-4"></div>
                        </div>
                    </div>
                    
                    <!-- Add New Course Tab -->
                    <div id="content-add-course" class="bg-white rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-2xl font-semibold mb-6">Add New Course</h2>
                        
                        <form id="add-course-form" class="space-y-6">
                            <div>
                                <label for="course-title" class="block text-gray-700 font-medium mb-2">Course Title</label>
                                <input type="text" id="course-title" name="title" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required>
                            </div>
                            
                            <div>
                                <label for="course-description" class="block text-gray-700 font-medium mb-2">Description</label>
                                <textarea id="course-description" name="description" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                            </div>
                            
                            <div>
                                <label for="course-price" class="block text-gray-700 font-medium mb-2">Price ($)</label>
                                <input type="number" id="course-price" name="price" min="0" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required>
                            </div>
                            
                            <div>
                                <label for="course-features" class="block text-gray-700 font-medium mb-2">Features (One per line)</label>
                                <textarea id="course-features" name="features" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="Feature 1&#10;Feature 2&#10;Feature 3"></textarea>
                            </div>
                            
                            <div>
                                <label for="course-target" class="block text-gray-700 font-medium mb-2">Target Audience (One per line)</label>
                                <textarea id="course-target" name="target" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="Beginners interested in...&#10;Professionals looking to..."></textarea>
                            </div>
                            
                            <div>
                                <label for="course-duration" class="block text-gray-700 font-medium mb-2">Duration</label>
                                <input type="text" id="course-duration" name="duration" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="e.g. 8 weeks, 10 hours, etc." required>
                            </div>
                            
                            <div id="add-course-error" class="p-4 bg-red-100 text-red-700 rounded-md hidden"></div>
                            
                            <div class="flex justify-end">
                                <button type="button" id="cancel-add-course" class="px-6 py-2 border border-gray-300 rounded-md mr-4 hover:bg-gray-100 transition">Cancel</button>
                                <button type="submit" class="bg-primary text-white px-6 py-2 rounded-md hover:bg-blue-600 transition">Create Course</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Edit Course Tab -->
                    <div id="content-edit-course" class="bg-white rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-2xl font-semibold mb-6">Edit Course</h2>
                        
                        <form id="edit-course-form" class="space-y-6">
                            <input type="hidden" id="edit-course-id">
                            
                            <div>
                                <label for="edit-course-title" class="block text-gray-700 font-medium mb-2">Course Title</label>
                                <input type="text" id="edit-course-title" name="title" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required>
                            </div>
                            
                            <div>
                                <label for="edit-course-description" class="block text-gray-700 font-medium mb-2">Description</label>
                                <textarea id="edit-course-description" name="description" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                            </div>
                            
                            <div>
                                <label for="edit-course-price" class="block text-gray-700 font-medium mb-2">Price ($)</label>
                                <input type="number" id="edit-course-price" name="price" min="0" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required>
                            </div>
                            
                            <div>
                                <label for="edit-course-features" class="block text-gray-700 font-medium mb-2">Features (One per line)</label>
                                <textarea id="edit-course-features" name="features" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                            </div>
                            
                            <div>
                                <label for="edit-course-target" class="block text-gray-700 font-medium mb-2">Target Audience (One per line)</label>
                                <textarea id="edit-course-target" name="target" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                            </div>
                            
                            <div>
                                <label for="edit-course-duration" class="block text-gray-700 font-medium mb-2">Duration</label>
                                <input type="text" id="edit-course-duration" name="duration" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" required>
                            </div>
                            
                            <div id="edit-course-error" class="p-4 bg-red-100 text-red-700 rounded-md hidden"></div>
                            
                            <div class="flex justify-end">
                                <button type="button" id="cancel-edit-course" class="px-6 py-2 border border-gray-300 rounded-md mr-4 hover:bg-gray-100 transition">Cancel</button>
                                <button type="submit" class="bg-primary text-white px-6 py-2 rounded-md hover:bg-blue-600 transition">Update Course</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Reviews Tab -->
                    <div id="content-reviews" class="bg-white rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-2xl font-semibold mb-6">Course Reviews</h2>
                        
                        <div id="reviews-loading" class="animate-pulse space-y-4">
                            <div class="h-24 bg-gray-200 rounded"></div>
                            <div class="h-24 bg-gray-200 rounded"></div>
                        </div>
                        
                        <div id="instructor-reviews" class="hidden">
                            <div id="no-reviews" class="text-center py-8 hidden">
                                <p class="text-gray-600">No reviews for your courses yet.</p>
                            </div>
                            
                            <div id="reviews-list" class="space-y-6"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">Growth Lab</h3>
                    <p class="text-gray-400 mb-4">Empowering individuals to master new skills and advance their careers through quality education.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-400 hover:text-white transition">Home</a></li>
                        <li><a href="courses.html" class="text-gray-400 hover:text-white transition">Courses</a></li>
                        <li><a href="about.html" class="text-gray-400 hover:text-white transition">About Us</a></li>
                        <li><a href="contact.html" class="text-gray-400 hover:text-white transition">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Course Categories</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Web Development</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Data Science</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Mobile Development</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">UX/UI Design</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Contact Us</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt mt-1 mr-2"></i>
                            <span>123 Education St, Learning City, 10001</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone-alt mr-2"></i>
                            <span>+1 (555) 123-4567</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope mr-2"></i>
                            <span>info@growthlab.com</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2023 Growth Lab. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="auth.js"></script>
    <script src="api.js"></script>
    <script>
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Dropdown menu toggle
        const dropdownButton = document.getElementById('dropdown-button');
        const dropdownMenu = document.getElementById('dropdown-menu');

        if (dropdownButton) {
            dropdownButton.addEventListener('click', () => {
                dropdownMenu.classList.toggle('hidden');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (event) => {
                const container = document.getElementById('dropdown-container');
                if (container && !container.contains(event.target)) {
                    dropdownMenu.classList.add('hidden');
                }
            });
        }

        // Tab switching
        const tabs = {
            'tab-courses': 'content-courses',
            'tab-add-course': 'content-add-course',
            'tab-reviews': 'content-reviews'
        };

        function switchTab(tabId) {
            // Hide all content sections
            Object.values(tabs).forEach(contentId => {
                document.getElementById(contentId).classList.add('hidden');
            });
            
            // Hide edit course section
            document.getElementById('content-edit-course').classList.add('hidden');
            
            // Show selected content
            document.getElementById(tabs[tabId]).classList.remove('hidden');
            
            // Update tab styling
            Object.keys(tabs).forEach(tab => {
                const element = document.getElementById(tab);
                if (tab === tabId) {
                    element.classList.add('bg-blue-50', 'text-primary', 'font-medium');
                    element.classList.remove('hover:bg-gray-100');
                } else {
                    element.classList.remove('bg-blue-50', 'text-primary', 'font-medium');
                    element.classList.add('hover:bg-gray-100');
                }
            });
        }

        Object.keys(tabs).forEach(tabId => {
            document.getElementById(tabId).addEventListener('click', () => {
                switchTab(tabId);
            });
        });

        // Add course button
        document.getElementById('add-course-button').addEventListener('click', () => {
            switchTab('tab-add-course');
        });

        document.getElementById('create-first-course').addEventListener('click', () => {
            switchTab('tab-add-course');
        });

        // Cancel buttons
        document.getElementById('cancel-add-course').addEventListener('click', () => {
            document.getElementById('add-course-form').reset();
            switchTab('tab-courses');
        });

        document.getElementById('cancel-edit-course').addEventListener('click', () => {
            document.getElementById('edit-course-form').reset();
            switchTab('tab-courses');
        });

        // Check auth status and load instructor data
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const user = await checkAuthStatus();
                
                if (!user) {
                    // Redirect to login if not authenticated
                    window.location.href = 'login.html?redirect=instructor-dashboard.html';
                    return;
                }
                
                // Load instructor courses
                await loadInstructorCourses();
                
                // Load reviews for instructor's courses
                await loadInstructorReviews();
                
                // Setup forms
                setupAddCourseForm();
                setupEditCourseForm();
            } catch (error) {
                console.error('Error loading instructor dashboard:', error);
            }
        });

        async function loadInstructorCourses() {
            try {
                const courses = await fetchInstructorCourses();
                
                // Hide loading, show content
                document.getElementById('instructor-courses-loading').classList.add('hidden');
                document.getElementById('instructor-courses').classList.remove('hidden');
                
                if (courses.length === 0) {
                    document.getElementById('no-courses').classList.remove('hidden');
                    document.getElementById('courses-list').classList.add('hidden');
                    return;
                }
                
                document.getElementById('no-courses').classList.add('hidden');
                document.getElementById('courses-list').classList.remove('hidden');
                
                // Display courses
                const coursesList = document.getElementById('courses-list');
                coursesList.innerHTML = '';
                
                courses.forEach(course => {
                    coursesList.innerHTML += `
                        <div class="border border-gray-200 rounded-lg p-4 flex flex-col md:flex-row justify-between items-start md:items-center">
                            <div>
                                <h3 class="font-semibold text-lg">${course.Title}</h3>
                                <p class="text-gray-600">$${course.Price} • ${course.Duration || 'Self-paced'}</p>
                            </div>
                            <div class="flex space-x-2 mt-4 md:mt-0">
                                <a href="course-detail.html?id=${course.id}" class="text-primary hover:text-blue-700 transition">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <button class="text-gray-600 hover:text-blue-700 transition edit-course-button" data-id="${course.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-gray-600 hover:text-red-600 transition delete-course-button" data-id="${course.id}">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                // Add event listeners for edit and delete buttons
                document.querySelectorAll('.edit-course-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const courseId = button.getAttribute('data-id');
                        editCourse(courseId);
                    });
                });
                
                document.querySelectorAll('.delete-course-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const courseId = button.getAttribute('data-id');
                        deleteCourse(courseId);
                    });
                });
            } catch (error) {
                console.error('Error loading instructor courses:', error);
            }
        }

        async function loadInstructorReviews() {
            try {
                const courses = await fetchInstructorCourses();
                const courseIds = courses.map(course => course.id);
                
                // Fetch all reviews
                const allReviews = await fetchReviews();
                
                // Filter reviews for instructor's courses
                const instructorReviews = allReviews.filter(review => 
                    courseIds.includes(review.course)
                );
                
                // Hide loading, show content
                document.getElementById('reviews-loading').classList.add('hidden');
                document.getElementById('instructor-reviews').classList.remove('hidden');
                
                if (instructorReviews.length === 0) {
                    document.getElementById('no-reviews').classList.remove('hidden');
                    document.getElementById('reviews-list').classList.add('hidden');
                    return;
                }
                
                document.getElementById('no-reviews').classList.add('hidden');
                document.getElementById('reviews-list').classList.remove('hidden');
                
                // Get course details for each review
                const reviewsWithCourses = await Promise.all(
                    instructorReviews.map(async review => {
                        const course = courses.find(c => c.id === review.course) || 
                                      await fetchCourseById(review.course);
                        return { ...review, courseName: course.Title };
                    })
                );
                
                // Display reviews
                const reviewsList = document.getElementById('reviews-list');
                reviewsList.innerHTML = '';
                
                reviewsWithCourses.forEach(review => {
                    const date = new Date(review.created).toLocaleDateString();
                    reviewsList.innerHTML += `
                        <div class="border border-gray-200 rounded-lg p-6">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="font-semibold">${review.user.username || 'Anonymous'}</h3>
                                    <p class="text-gray-500 text-sm">${date}</p>
                                </div>
                                <div>
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">
                                        ${review.courseName}
                                    </span>
                                </div>
                            </div>
                            <p class="text-gray-700">${review.body}</p>
                        </div>
                    `;
                });
            } catch (error) {
                console.error('Error loading instructor reviews:', error);
            }
        }

        function setupAddCourseForm() {
            const addCourseForm = document.getElementById('add-course-form');
            const addCourseError = document.getElementById('add-course-error');
            
            addCourseForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const courseData = {
                    Title: document.getElementById('course-title').value,
                    Description: document.getElementById('course-description').value,
                    Price: document.getElementById('course-price').value,
                    Features: document.getElementById('course-features').value,
                    Target: document.getElementById('course-target').value,
                    Duration: document.getElementById('course-duration').value
                };
                
                try {
                    addCourseError.classList.add('hidden');
                    
                    const result = await createCourse(courseData);
                    
                    if (result.id) {
                        addCourseForm.reset();
                        await loadInstructorCourses();
                        switchTab('tab-courses');
                    } else {
                        throw new Error('Failed to create course');
                    }
                } catch (error) {
                    console.error('Error creating course:', error);
                    
                    addCourseError.textContent = 'Failed to create course. Please try again.';
                    addCourseError.classList.remove('hidden');
                }
            });
        }

        async function editCourse(courseId) {
            try {
                const course = await fetchCourseById(courseId);
                
                // Fill form with course data
                document.getElementById('edit-course-id').value = course.id;
                document.getElementById('edit-course-title').value = course.Title;
                document.getElementById('edit-course-description').value = course.Description;
                document.getElementById('edit-course-price').value = course.Price;
                document.getElementById('edit-course-features').value = course.Features;
                document.getElementById('edit-course-target').value = course.Target;
                document.getElementById('edit-course-duration').value = course.Duration || '';
                
                // Show edit form
                Object.values(tabs).forEach(contentId => {
                    document.getElementById(contentId).classList.add('hidden');
                });
                document.getElementById('content-edit-course').classList.remove('hidden');
                
                // Update tab styling
                Object.keys(tabs).forEach(tab => {
                    document.getElementById(tab).classList.remove('bg-blue-50', 'text-primary', 'font-medium');
                    document.getElementById(tab).classList.add('hover:bg-gray-100');
                });
            } catch (error) {
                console.error('Error loading course for editing:', error);
            }
        }

        function setupEditCourseForm() {
            const editCourseForm = document.getElementById('edit-course-form');
            const editCourseError = document.getElementById('edit-course-error');
            
            editCourseForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const courseId = document.getElementById('edit-course-id').value;
                const courseData = {
                    Title: document.getElementById('edit-course-title').value,
                    Description: document.getElementById('edit-course-description').value,
                    Price: document.getElementById('edit-course-price').value,
                    Features: document.getElementById('edit-course-features').value,
                    Target: document.getElementById('edit-course-target').value,
                    Duration: document.getElementById('edit-course-duration').value
                };
                
                try {
                    editCourseError.classList.add('hidden');
                    
                    const result = await updateCourse(courseId, courseData);
                    
                    if (result.id) {
                        editCourseForm.reset();
                        await loadInstructorCourses();
                        switchTab('tab-courses');
                    } else {
                        throw new Error('Failed to update course');
                    }
                } catch (error) {
                    console.error('Error updating course:', error);
                    
                    editCourseError.textContent = 'Failed to update course. Please try again.';
                    editCourseError.classList.remove('hidden');
                }
            });
        }

        async function deleteCourse(courseId) {
            if (confirm('Are you sure you want to delete this course? This action cannot be undone.')) {
                try {
                    await deleteCourseById(courseId);
                    await loadInstructorCourses();
                } catch (error) {
                    console.error('Error deleting course:', error);
                    alert('Failed to delete course. Please try again.');
                }
            }
        }
    </script>
</body>
</html>